---
 - name: Get conf
   hosts: Chris EX4200 devices in Ams
   roles:
    - Juniper.junos
   connection: local
   gather_facts: no
   vars_files:
    - vars.yml
   tasks:
#   - name: remove host directory
#     file: path=configs/{{inventory_hostname}}.conf state=absent
#     register: baseconfdir
#   - name: create host-baseconf directory
#     file: path=configs state=directory 
   - name: Retrieve configuration from devices running Junos
     junos_get_config:
      host={{ inventory_hostname }}
      user={{ USERNAME }}
      passwd={{ DEVICE_PASSWORD }}
      dest=configs/{{ inventory_hostname }}.conf
      format=text
      logfile=get_config.log
      filter="system/login"
